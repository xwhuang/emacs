\tikzset{me/.style={fill=gray!30}}
\tikzset{ar/.style={->,>=stealth}}
\newcommand{\fns}[1]{\footnotesize{#1}}
\begin{tikzpicture}[yscale=0.6]
  \draw[fill=gray!30]
  (0,0) rectangle (12,0.8)
  node at (0.75,0.4) {\fns{以太网首部}} node at (0.75, -0.2) {\fns{14}}
  (1.5, 0) -- (1.5, 0.8)
  node at (2.5,0.4) {\fns{ip首部}} node at (2.5, -0.2) {\fns{20}}
  (3.5, 0) -- (3.5, 0.8) node at (4.5,0.4) {\fns{tcp/udp首部}}
  (5.5, 0) -- (5.5, 0.8) node at (8,0.4) {\fns{应用数据}}
  (10.5,0) -- (10.5,0.8) 
  node at (11.25,0.4) {\fns{以太网尾部}} node at (11.25,-0.2) {\fns{4}};

  \draw (0, -0.4) -- (0, -1)  (12, -0.4) -- (12, -1);
  \draw[ar] (5,-0.7) -- (0, -0.7);
  \draw[ar] (7,-0.7) -- (12,-0.7) node at (6,-0.7) {\fns{以太网帧}};

  \draw (1.5, -1) -- (1.5, -1.6)  (10.5, -1) -- (10.5, -1.6);
  \draw[ar] (5,-1.3) -- (1.5, -1.3);
  \draw[ar](7,-1.3) -- (10.5,-1.3) node at (6,-1.3) {\fns{46-1500字节}};

  %ip
  \draw[fill=gray!30,yshift=1.8cm]
  (1.5, 0) rectangle (10.5,0.8)
  node at (2.5,0.4) {\fns{ip首部}}
  (3.5, 0) -- (3.5, 0.8) node at (4.5,0.4) {\fns{tcp/udp首部}}
  (5.5, 0) -- (5.5, 0.8) node at (8,0.4) {\fns{应用数据}};

  \draw[ar,dashed] (1.5, 1.8) -- (1.5, 0.8);
  \draw[ar,dashed] (10.5,1.8) -- (10.5,0.8);
  \draw[ar] (5,1.4) -- (1.5, 1.4);
  \draw[ar] (7,1.4) -- (10.5,1.4) node at (6,1.4) {\fns{ip数据报}};

  %tcp/udp
  \draw[fill=gray!30,yshift=3.6cm]
  (3.5, 0) rectangle (10.5,0.8) node at (4.5,0.4) {\fns{tcp/udp首部}}
  (5.5, 0) -- (5.5, 0.8) node at (8,0.4) {\fns{应用数据}};

  \draw[ar,dashed] (3.5, 3.6) -- (3.5, 2.6);
  \draw[ar,dashed] (10.5,3.6) -- (10.5,2.6);
  \draw[ar] (5.5,3.1) -- (3.5, 3.1);
  \draw[ar] (8.5,3.1) -- (10.5,3.1) node at (7,3.1) {\fns{tcp段/udp报文}};

  %application data
  \draw[fill=gray!30,yshift=5.4cm]
  (5.5, 0) rectangle (10.5,0.8) node at (6.5,0.4) {\fns{应用首部}}
  (7.5, 0) -- (7.5, 0.8) node at (9, 0.4) {\fns{用户数据}};
  \draw[ar,dashed,yshift=3.6cm] (5.5, 1.8) -- (5.5, 0.8);
  \draw[ar,dashed,yshift=3.6cm] (10.5, 1.8) -- (10.5, 0.8);

  %application data
  \draw[fill=gray!30,yshift=7.2cm]
  (7.5, 0) rectangle (10.5,0.8) node at (9,0.4) {\fns{用户数据}};
  \draw[ar,,dashed,yshift=5.4cm] (7.5, 1.8) -- (7.5, 0.8);
  \draw[ar,,dashed,yshift=5.4cm] (10.5, 1.8) -- (10.5, 0.8);

  

\end{tikzpicture}
